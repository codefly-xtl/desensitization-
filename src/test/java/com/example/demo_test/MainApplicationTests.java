package com.example.demo_test;

import com.example.demo_test.utils.KeywordReplacer;
import com.hankcs.hanlp.restful.HanLPClient;
import org.junit.jupiter.api.Test;
import org.springframework.boot.test.context.SpringBootTest;

import java.io.IOException;
import java.util.*;

@SpringBootTest
public class MainApplicationTests {

    @Test
    public void contextLoads() throws IOException {
        HanLPClient client = new HanLPClient("https://hanlp.hankcs.com/api", null);
        String content = """
                 采购合同 甲方：深圳市星桐科技有限公司 通讯地址：深圳市福田区华强北街道福强社区红荔路2001号四川大厦A座1611 联系人：赵士雄 电话：17526529778 电子邮箱：zhaoshixiong1@tal.com &nbsp; 乙方：北京荣泽嘉业商贸有限公司 通讯地址：北京市房山区拱辰街道月华大街1号A8-1777 联系人：张燕 电话：13911968191 电子邮箱：rzjy@bjrongze.com 依据《中华人民共和国民法典》及有关法律、法规的规定，甲乙双方在平等、自愿的基础上，本着友好合作、协商一致的原则，就甲方向乙方采购事宜，在北京市海淀区订立本合同。 1、 释义（除非文本另有不同要求） 1、文中“双方”指甲方和乙方，“一方”指甲方和乙方中的任何一方。 2、文中所涉及费用均以人民币“元”为计量单位。 3、文中“年、月、日”均指公历年、月、日。 2、 合同项目 1、甲方向乙方购买电子设备（以下简称“产品”）。 2、乙方向甲方免费提供产品的送货、安装及售后服务。 3、 电子设备、耗材类型及相关价格 1、甲方向乙方购买电子设备产品名称、数量、价格等具体如附件一采购产品明细所示。 本合同总金额含税总价为人民币￥【11,248】 元（以下简称“合同总金额”），人民币大写：【壹万壹仟贰佰肆拾捌圆整】。 本合同项下的合同总金额均为包含增值税的含税价（税率为13%）,上述价款已包含本合同项下甲方应支付的所有款项，甲方无须再支出任何其他款项。 在合同履行期间如遇国家税率调整，则价税合计相应调整，税额根据乙方相关纳税义务时间的法定税率计算。 2、乙方保证提供的产品完全符合国家和行业相关法律法规、标准，符合安全、环保及职业健康等要求，并符合甲方使用要求、双方约定的技术及性能要求。 4、 合同价款 1、供货价格：在本合同中约定的产品的同等产品中，甲方采购产品价格应低于厂家零售报价及市场均价；乙方为甲方提供原装设备零配件供应，零配件价格也须低于生产厂家零售价及市场均价。 同时，甲方采购产品价格不得高于京东自营线上同款商品采购到手价格。 如甲方发现乙方提供的产品价格、零配件价格不符合前述约定的，甲方有权拒收产品、零配件，并有权解除本合同、要求乙方退还甲方已支付的所有款项，乙方应赔偿甲方由此产生的所有直接及间接损失。 2、本合同总价款已包括产品的硬件、软件和随货零配件（如有）全部移交至甲方所需的一切费用（包括但不限于税费、包装、运输、保险费，以及卸货、安装、调试、验收、培训和售后服务费等）。 5、 付款方式及期限 1、甲乙双方同意按以下方式支付： 乙方完成全部产品交付并经甲方验收合格后并收到乙方全额合法正规发票后60个自然日内，甲方一次性支付全部货款。 2、甲乙双方同意选择以银行转账的方式进行支付各项费用。乙方用于接收价款的银行账户信息以及甲方的开票信息如下： 乙方收款信息 甲方开票信息 账户名称：北京荣泽嘉业商贸有限公司 账 号：631974667 开 户 行：中国民生银行总部基地支行 以具体订单采购主体的开票信息为准 乙方确认，上述账户信息真实、准确，甲方将款项支付至上述账户，即视为已经履行了款项支付义务，乙方变更账户收款信息的，应于变更前7个工作日以书面方式通知甲方，否则由此造成的一切损失由乙方自行承担。 3、 乙方应向甲方提供的发票类型为以下第【1】类发票：（1）增值税专用发票；（2）增值税普通发票。如甲方要求在下次付款前变更发票类型的，甲方应在乙方开票前提前 7个工作日通知乙方，乙方应根据甲方要求开具对应类型的发票。 4、如乙方未依约提供发票、提供的发票不符合约定或提供非合法有效发票的，乙方应赔偿甲方发票金额的25％作为违约金。如甲方要求乙方提供增值税专用发票，而乙方实际提供普通发票的，乙方须在提供发票后三个工作日内将不含税金额*乙方提供应税行为适用的增值税税率或适用征收率计算的金额作为违约金支付给甲方。 6、 质量保证及权利瑕疵担保 1、质量保证 （1）乙方保证所提供所有产品为原厂正品，质量符合国家、行业标准，以及双方约定或实物样品（如有）标准。不存在任何危及人身、财产安全的危险。 （2）因乙方提供的产品及安装有质量缺陷，给甲方或第三人造成人身或财产损失的（包含直接损失和间接损失，以及甲方维权成本），乙方应承担全部赔偿责任。同时，甲方有权单方无责解除合同。 （3）乙方生产的产品必须符合以下标准：  1）中国强制性产品认证（3C认证）（如适用）；  2）强制性国家标准及同行业推荐国家标准、行业标准及企业标准的规定（以更严者为准）；  3）产品包装及本体须完整标注：产品名称、型号、执行标准、生产厂名称及地址、警示标识（如适用）、适用年龄、合格证；  4）不得存在虚假标注、仿冒商标或侵犯第三方知识产权的情形。 （4）甲方发现产品为“三无产品”（无生产厂名、无生产厂址或无产品质量合格证明）的，有权要求乙方24小时内书面说明原因，并采取以下措施：  1）于7日内无条件返工或更换合格产品，费用由乙方承担；  2）若导致甲方被市场监管部门处罚或消费者索赔的，乙方需全额赔偿甲方损失（含罚款、赔偿金、律师费、商誉损失等）。 2、权利瑕疵担保 （1）乙方保证其向甲方出售和交付的所有产品（含赠品）是其合法生产或有权经销的，产品全新、未经使用，且没有任何权利瑕疵。乙方同时保证其履行本合同涉及的一切相关资质、授权以及所有权、知识产权为其合法取得并在甲方要求期限内依法持续所有，不存在侵犯任何第三方所有权、知识产权和商业秘密等权益或妨碍甲方加工、组装、使用、二次销售的情况，任何第三方不会基于知识产权或其他权属向甲方主张任何权利或要求。 （2）若甲方因乙方或乙方交付的产品原因而被第三方追索、起诉、控告，或被指控侵犯知识产权等合法权利，或受到司法、行政机关的调查、处罚，乙方应自费处理上述纠纷及事务，退还甲方已经支付的全部费用，并赔偿甲方因此而遭受的所有损失（包括但不限于损害赔偿金、律师费、公证费、调查费等为应对第三方而支付的费用及其他相关费用）。同时，甲方有权单方无责解除合同。 7、 产品包装、运输及安装 1、乙方负责对产品进行包装和标识，费用由乙方承担，包装物不回收。产品包装应符合国家、行业标准和产品性质标准，因包装不良而造成的产品残损、丢失应当由乙方负责；因包装不当或采取的防护措施不当以致产品损坏或丢失的，由乙方负责补足、更换，由此给甲方造成损失的，乙方负全部赔偿责任。 2、乙方提供的产品应满足在运输、仓储、搬运等过程中的防护要求，保证产品安全无损到达甲方指定地点。有关收货的注意事项，乙方应在交货前向甲方明示（包括但不限于在产品外包装显著位置标明防护标志（如有必要））。 3、产品在完全移交甲方控制前的运输、保险、仓储、装卸及搬运均由乙方负责并承担费用。 4、乙方须按照合同的规定，在各方面都能满足甲方要求下，执行合同规定的工作，包括完成所供应产品的安装、调试、试运行等工作，确保产品及产品安装等能通过甲方验收，并取得产品合法投入运行使用所需的全部许可证照（如需）。 5、乙方保证所提供产品外包装完好，原厂商配置，全新未使用过，产品型号符合甲方需求；且需符合同类产品的国家标准、行业标准。乙方负责免费将产品运输和安装到甲方指定的位置。乙方保证安装工程的质量适合产品的要求，保证安装工程牢固适合产品运转。如果产品质量与国家、北京市规定的标准或甲方要求的标准不符，乙方应在【7】天内负责更换；如更换后仍不能达到前述标准，甲方有权对此部分产品退货和解除本合同，如此部分产品已支付相应货款，乙方须在【7】个工作日内全部退还给甲方，同时，乙方应向甲方支付签约总价【5】%的违约金。 8、 交货方式、地点与期限 1、交货方式、地点：乙方或乙方委托第三方配送至甲方指定地址，以未来采购系统EP订单为准。 产品相关的单证、资料文档（包括但不限于产品的合格证、保修单、装箱单、使用说明书及检验报告等）应附随货一并交付指定联系人。该等资料费以及可能的授权费，均已包含在产品价格中，无须甲方另行支付。 2、交货时间：【合同签订】后7个自然日内完成交货。 如遇甲方有急用产品订购，则乙方应在接甲方书面通知当日或以最短时间将甲方所订产品运送到甲方指定地点。 如经双方沟通需要仓储，乙方应至少在实际交付日期前三天将产品对仓储的特殊要求和其他注意事项（如有）书面通知甲方。 9、 验收 1、产品运送至甲方指定地点后，由甲方指定人员与乙方共同清点数量，并对产品的表面特征（如品种、品牌、型号、规格参数、包装、标识等）进行初步检验，检验方式依据甲方具体要求确定。产品初验合格后方可办理签收、安装（如需）及移交、验收手续。 2、产品如需安装的，乙方应在甲方收货后3个工作日内免费上门安装与调试，并为甲方人员提供必要的培训或指导，直至满足甲方的使用需求。 3、产品签收并完全移交甲方控制后，产品需要安装的，在乙方安装与调试完成后，方可办理验收或入库手续，甲方验收合格后，货物所有权及风险随之转移。同时，甲方有权进一步查验、测试产品的用料、品质以及安全、性能等内在质量表现，并在合同约定的“三包”期限内提出质量异议。对于存在瑕疵的产品，甲方签收、签署验收合格文件或付款不影响甲方按合同约定要求乙方退换货或采取其他补救措施的权利。 4、 产品交付与合同约定不符的，甲方有权在货到48小时内拒收或要求乙方免费更换，乙方需在交货期内或甲方指定宽限期内补换合格品并完成移交。乙方自行承担不合格产品的保管责任及退换货运费。 10、 售后、保修及其他服务 1、乙方所提供产品均实行以下“三包”：自验收合格之日起，如出现质量问题【7】个工作日内包退，【15】个工作日内包换，【一】年内免费保修。产品明细对保修期限、范围等优于约定的，从其约定。 2、保修期内，乙方免费提供更换零配件、维护保养、系统升级（如有）等原厂售后服务，并在接到甲方报修通知后【24】小时内反应报修原厂并并免费现场处理。同一严重质量问题，修理了两次仍达不到标准要求的，凭修理记录和有关证明，乙方须为甲方免费调换同规格型号、同样式的产品或甲方按规定退换，同时，甲方有权解除本协议，并要求乙方退还甲方已支付的全部费用。 3、保修期过后，如相关零件损坏，乙方可按合同约定适当收取相应的零件费用，乙方在【24】小时内到达现场进行维修。 4、乙方应提供有效的售后联系人和联系电话，如有变更，乙方应及时、主动通知甲方。 5、乙方未按合同约定履行售后义务的，甲方有权收取200元/次的违约金，乙方应在收到甲方书面通知后 2 个工作日内支付至甲方指定账号或甲方有权在质保金（如有）中直接扣除；乙方拒绝履行售后义务或无故迟延履行且经甲方书面催告仍不履行的，甲方有权另行委托第三方处理并没收全部质保金（如有），相关处理费用以及由此给甲方造成的损失均由乙方承担，同时甲方有权解除本合同，乙方应退还甲方已支付的全部费用。 11、 违约责任 1、甲方无正当理由未按合同规定的时间足额付款的（因乙方交货、开票不符合合同规定等非甲方原因造成的迟延除外），经乙方书面催告后仍未支付的，每延期一日应向乙方支付逾期未支付金额的万分之一作为违约金，累计不得超过逾期未付金额的百分之一。 2、乙方未按合同规定时间将产品运到甲方指定地点（经甲方书面允许可以延期交付的产品除外）或未按约定时间提供安装等服务的，每延期一日，乙方应向甲方支付本合同总金额的千分之一作为违约金，并以此累计。如逾期超过【7】日，甲方有权单方无责解除本合同，并无需向乙方支付任何费用，乙方应在收到解除通知之日起5个工作日内将甲方已支付的相应货款（如有）全部退还。 3、在“三包”期内，发现乙方交付“三无产品”或不符合本合同质量标准的，甲方有权要求修理、更换、退货、退款，并停付未付款项，乙方应在收到退货通知之日起5个工作日内将甲方已支付的相应货款全部退还，并办理完退货手续。不合格产品经过两次更换或修理仍不合格，或不合格品率超过5%的，甲方有权单方无责解除合同，并有权对不予接受的货物要求乙方按上述期限办理退款、退货。因乙方产品问题导致甲方被市场监管部门通报、产品下架、召回等情形的，乙方需赔偿甲方直接及间接损失（包括但不限于退货款、消费者赔偿、行政处罚、诉讼费用等）。 4、因乙方违约，甲方按合同约定要求解除合同的，相应退货办理及其费用、损失均由乙方承担，乙方还应在收到解除通知之日起5个工作日内向甲方支付相当于本合同总金额百分之十的违约金，违约金不足以弥补甲方损失（包括但不限于律师费、公证费、调查费等为维权而支出的合理费用以及为赔付第三方而支出的损害赔偿金和相关费用）的，甲方有权继续向乙方追偿。 5、如甲方发现有悖于第四条第1项的情况，但乙方未提前通知并未说明原因的（例如：线上代购产生的税费、服务费等），甲方有权要求乙方补齐差价并就此损失承担20%的赔偿责任。 6、如甲方发现乙方提供的产品不是原厂正品，一经发现，乙方需立即更换，并须支付本合同所有订单金额的三倍金额作为赔偿，同时取消未来三次参标资格。 7、乙方及产品厂商不得采取任何技术手段窃取、截存、保留、使用甲方数据（包括但不限于甲方提供的数据及甲方使用产品服务过程中产生的全部服务数据等），若甲方发现乙方或产品厂商私自留存、使用甲方数据的，甲方有权要求乙方及厂商按照合同总金额2倍向甲方支付违约赔偿金。 8、除以上情形外，任何一方违反本合同约定的，应赔偿给另一方造成的损失，该损失包括但不限于对另一方所造成的直接损失、可得利益损失、另一方支付给第三方的赔偿费用、违约金、罚款、调查取证费用、公证费、诉讼费用、律师费用以及因此而支付的其他合理费用。 12、 合同的变更与终止 1、除本合同另有约定外，未经甲乙双方一致书面同意，任何一方不得擅自变更、终止合同。 2、本合同任何一方注销且无任何承继实体、破产、解散，本合同自动终止。 13、 通知 1、本合同中任何通知、书面材料往来等均应当通过文首约定的双方联系人以书面形式（包括电子邮件）送达。 2、任何一方变更联系方式的，应提前15日有效告知另一方，否则，由此造成的一切后果由未通知方承担。 14、 不可抗力 1、甲乙双方中任何一方因政府禁令、现行政策、法律或法规变更、罢工、疫情、暴乱、洪灾、火灾、地震、台风等在本合同订立时不能预见、其发生或后果不能避免且不能克服的不可抗力，从而不能履行全部或部分义务，或不能按期履行义务的，受影响的一方无需承担违约责任，但应及时通知另一方并采取必要的措施，以减轻可能给对方造成的损失，同时应在合理的时间内提供有关机构出具的有效证明。 2、因不可抗力导致合同目的无法实现或遭遇不可抗力持续影响超过60天的，双方均可解除合同而无需承担任何违约责任。 15、 保密义务 1、甲乙双方对于本合同的签订、内容及在履行本合同期间所获知的另一方的商业秘密负有保密义务。甲乙双方均应严格保守，不得向任何第三方透露，也不得在本合同目的外擅自使用或允许第三人使用。但按照法律的强制性规定以及司法机关的要求，必须披露的，应在披露后告知对方。 2、本合同中商业秘密，包括但不限于：本合同内容、购销价格、客户名单、客户信息、销售渠道、软件系统、纳税情况以及一方向对方披露的不为外界所知的其他信息。 3、如对方提出要求，任何一方均应将载有对方保密信息的任何文件、资料或软件等，在本合同终止后按对方要求归还对方，或予以销毁，或进行其他处置，且不得继续使用这些保密信息。 4、任何一方均应告知、督促其因履约而必须获知本合同内容以及因合作而获知对方商业秘密的雇员、代理人等人员遵守保密条款，并对其雇员、代理人等人员的行为承担责任。 5、双方确认：用户数据信息的所有权归用户本人所有。协议双方不得以任何理由用于合同项下之外的业务，不得以任何方式传播、转让、出售、公开披露用户数据信息。 16、 争议解决和适用法律 1、与本合同有关的或因执行本合同所产生的争议，应由双方友好协商解决，协商不成的，任何一方均可向合同签订地有管辖权人民法院提起诉讼。 2、本合同的订立、效力、执行、解释及争议解决均应适用中国法律。 17、 其他 1、本合同未尽事宜或任何修改，应由甲、乙双方协商后书面签订补充协议。任何一方员工、代理人所作出的任何许诺或保证，无论发生在本合同签订之前或之后，均不发生导致本合同变更或表见代理的法律效果。 2、附件一《采购产品明细》、附件二《反贪污贿赂条款》、附件三《实物类验收单》是本合同内容的组成部分，与本合同具有同等法律效力。 3、本合同适用于甲方关联主体。在本合同有效期内，如【甲方关联主体（系指好未来教育集团（NYSE：TAL）最新年报中更新并披露的全部法律主体以及由披露主体直接或间接控制的其他法律主体）统一通过好未来未来采购系统】向乙方发出采购订单采购与本合同内容相同的产品或服务，乙方同意向甲方关联主体承担本合同约定的各项权利义务。甲方及甲方各关联企业，按照各自的订单和乙方分别结算并单独享有权利、承担义务，相互之间互不承担连带责任。 4、本合同自甲、乙双方加盖公章或合同章后生效。合同正本一式​​贰份，甲乙双方各执壹份，具有同等法律效力。 （以下无正文） （本页为签署页，无正文） 甲方（签章）： 日期： 年 月 日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 乙方（签章）： 日期： 年 月 日 附件一：采购产品明细 序号 产品名称 品牌 型号 详细规格/参数配置 数量 单位 含税单价（元） 税率 含税金额（元） 1 科大讯飞S30学习机 科大讯飞 S30 8+256G 1 台 3960 13% 3960 2 猿辅导R1学习机 猿辅导 R1 8+256G 1 5290 5290 3 VIVO PAD SE平板电脑 VIVO VIVOPAD SE 6+128G 2 999 1998 总价：11248元（以上报价包含13%增值税专用发票及运费，运送地址均为北京市昌平区好未来大楼） 附件二： 反贪污贿赂条款 1、甲乙双方均清楚并严格遵守中国反贪污贿赂、反不正当竞争相关法律规定以及《美国反海外腐败法》的相关规定，在履行本合同过程中不向任何政府官员、国有企业雇员或公共机构人员提供任何贿赂。 2、乙方保证未向甲方的任何员工、代理人、代表或其他相关人员提供或赠予任何合同约定外的明扣、暗扣、好处费、现金、有价证券、购物卡、实物、礼品、请吃、旅游等形式的不当利益，而且将来也不会提供或赠予此类不当利益。 3、如乙方或乙方经办人违反本条任何一款约定的，视为严重违约，甲方有权解除合同，并停止支付本协议项下任何费用，且乙方应支付双方合作期限内总费用的50%作为违约金，如该违约金不足以弥补甲方全部直接或间接损失的，乙方应继续承担赔偿责任。涉嫌犯罪的，甲方可提请司法机关调查处理，依法追究其法律责任。 4、乙方可通过以下方式进行举报，甲方将对所有信息提供者及所提供的全部资料严格保密： 举报电子邮箱：jubao@tal.com 附件三（供验收时参照适用）： 实物类验收单 采购方单位名称 　 　 好未来采购订单 （EP****） 供应商名称 　 供应商联系人及联系方式： 验收明细 如商品名目较多无法列示，请另附具体明细单如有发货单、送货单包含物品明细等同样可以作为明细单列示。（明细单需加盖供货方专用章)， 发货数量（供应商填写） 好未来验收人填写 物品名称 品牌 规格型号 单位 数量 实际签收数量 如有不需要结算的备品，请单独注明 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 验收项目及情况说明 验收项目 好未来验收人填写 - 检查情况说明 包装、外观等情况 □合格 □部分合格 □其他情况请备注说明： 安装、调试情况 　 □合格 □部分合格 □其他情况请备注说明： 其他检查项目及要求见合同验收条款 □合格 □部分合格 □其他情况请备注说明： 好未来验收人填写 - 验收结论（如涉及与“实际签收数量”不一致，请明确数量说明） 检验结论 □全部符合 □部分符合 □全部不符合 验收/处理意见，如有说明，请在此备注 　 验收人签字： 供应商盖章确认 验收人员工号： 验收日期： 本验收单正本一式二份（联），双方各执一份（联），经采购单位代表签字和供应商盖章确认后，方可作为验收、结算的必要凭据，双方务必谨慎填制和保管。 8 / 18
                """;
        String[] tasks = {"ner/msra"};
        Map<String, List> parse = client.parse(content, tasks, null);
        List<List<List>> nerResults = parse.get("ner/msra");
        Set<String> entityTypesToReplace = new HashSet<>(Arrays.asList(
                "PERSON", "LOCATION", "DATE", "ORGANIZATION", "MONEY", "PHONE", "POSTALCODE", "WWW","PERCENT"
        ));
        List<String> allSensitiveWords = findAllSensitiveWords(nerResults, entityTypesToReplace);
        System.out.println("替换前: " + content);
        String result = KeywordReplacer.replaceWithAsterisks(content, allSensitiveWords);
        System.out.println("替换后: " + result);
    }

    private List<String> findAllSensitiveWords(List<List<List>> sentenceNerResults, Set<String> entityTypes) {
        Set<String> sensitiveWords = new HashSet<>();
        for (List<List> sentenceEntities : sentenceNerResults) {
            for (List entityInfo : sentenceEntities) {
                String entityText = (String) entityInfo.get(0);
                String entityType = (String) entityInfo.get(1);
                System.out.println(entityType);
                if (entityTypes.contains(entityType)) {
                    sensitiveWords.add(entityText);
                }
            }
        }
        return sensitiveWords.stream().toList();
    }
}